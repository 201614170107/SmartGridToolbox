%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%                                                                  %%%%%
%%%%      NICTA Energy System Test Case Archive (NESTA) - v0.1.5      %%%%%
%%%%              Optimal Power Flow - Typical Operation              %%%%%
%%%%                       30 - October - 2014                        %%%%%
%%%%                                                                  %%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%   CASE39 Power flow data for 39 bus New England system.
%   Please see CASEFORMAT for details on the case file format.
%
%   Data taken from [1] with the following modifications/additions:
%
%       - Renumbered gen buses consecutively (as in [2] and [4])
%       - Added Pmin = 0 for all gens
%       - Added Qmin, Qmax for gens at 31 & 39 (copied from gen at 35)
%       - Added Vg based on V in bus data (missing for bus 39)
%       - Added Vg, Pg, Pd, Qd at bus 39 from [2] (same in [4])
%       - Added Pmax at bus 39: Pmax = Pg + 100
%       - Added line flow limits and area data from [4]
%       - Added voltage limits, Vmax = 1.06, Vmin = 0.94
%       - Added identical quadratic generator costs
%       - Increased Pmax for gen at bus 34 from 308 to 508
%         (assumed typo in [1], makes initial solved case feasible)
%       - Re-solved power flow
% 
%   Notes:
%       - Bus 39, its generator and 2 connecting lines were added
%         (by authors of [1]) to represent the interconnection with
%         the rest of the eastern interconnect, and did not include
%         Vg, Pg, Qg, Pd, Qd, Pmin, Pmax, Qmin or Qmax.
%       - As it was the swing bus, bus 31 did not include and Q limits.
%       - The voltages, etc in [1] appear to be quite close to the
%         power flow solution of the case before adding bus 39 with
%         its generator and connecting branches, though the solution
%         is not exact.
%       - Explicit voltage setpoints for gen buses are not given, so
%         they are taken from the bus data, however this results in two
%         binding Q limits at buses 34 & 37, so the corresponding
%         voltages have probably deviated from their original setpoints.
%       - The generator locations and types are as follows:
%           1   30      hydro
%           2   31      nuke01
%           3   32      nuke02
%           4   33      fossil02
%           5   34      fossil01
%           6   35      nuke03
%           7   36      fossil04
%           8   37      nuke04
%           9   38      nuke05
%           10  39      interconnection to rest of US/Canada
%
%   This is a solved power flow case, but it includes the following
%   violations:
%       - Pmax violated at bus 31: Pg = 677.87, Pmax = 646
%       - Qmin violated at bus 37: Qg = -1.37,  Qmin = 0
%
%   References:
%   [1] G. W. Bills, et.al., "On-Line Stability Analysis Study"
%       RP90-1 Report for the Edison Electric Institute, October 12, 1970,
%       pp. 1-20 - 1-35.
%       prepared by E. M. Gulachenski - New England Electric System
%                   J. M. Undrill     - General Electric Co.
%       "generally representative of the New England 345 kV system, but is
%        not an exact or complete model of any past, present or projected
%        configuration of the actual New England 345 kV system.
%   [2] M. A. Pai, Energy Function Analysis for Power System Stability,
%       Kluwer Academic Publishers, Boston, 1989.
%       (references [3] as source of data)
%   [3] Athay, T.; Podmore, R.; Virmani, S., "A Practical Method for the
%       Direct Analysis of Transient Stability," IEEE Transactions on Power
%       Apparatus and Systems , vol.PAS-98, no.2, pp.573-584, March 1979.
%       URL: http://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=4113518&isnumber=4113486
%       (references [1] as source of data)
%   [4] Data included with TC Calculator at http://www.pserc.cornell.edu/tcc/
%       for 39-bus system.
%
function mpc = nesta_case39_epri
mpc.version = '2';
mpc.baseMVA = 100.0;

%% bus data
%	bus_i	type	Pd	Qd	Gs	Bs	area	Vm	Va	baseKV	zone	Vmax	Vmin
mpc.bus = [
	1	 1	 97.6	 44.2	 0.0	 0.0	 2	     1.0394	   -13.5366	 345.0	 1	     1.0600	     0.9400;
	2	 1	 0.0	 0.0	 0.0	 0.0	 2	     1.0485	    -9.7853	 345.0	 1	     1.0600	     0.9400;
	3	 1	 322.0	 2.4	 0.0	 0.0	 2	     1.0307	   -12.2764	 345.0	 1	     1.0600	     0.9400;
	4	 1	 500.0	 184.0	 0.0	 0.0	 1	     1.0045	   -12.6267	 345.0	 1	     1.0600	     0.9400;
	5	 1	 0.0	 0.0	 0.0	 0.0	 1	     1.0060	   -11.1923	 345.0	 1	     1.0600	     0.9400;
	6	 1	 0.0	 0.0	 0.0	 0.0	 1	     1.0082	   -10.4083	 345.0	 1	     1.0600	     0.9400;
	7	 1	 233.8	 84.0	 0.0	 0.0	 1	     0.9984	   -12.7556	 345.0	 1	     1.0600	     0.9400;
	8	 1	 522.0	 176.6	 0.0	 0.0	 1	     0.9979	   -13.3358	 345.0	 1	     1.0600	     0.9400;
	9	 1	 6.5	 -66.6	 0.0	 0.0	 1	     1.0383	   -14.1784	 345.0	 1	     1.0600	     0.9400;
	10	 1	 0.0	 0.0	 0.0	 0.0	 1	     1.0178	    -8.1709	 345.0	 1	     1.0600	     0.9400;
	11	 1	 0.0	 0.0	 0.0	 0.0	 1	     1.0134	    -8.9370	 345.0	 1	     1.0600	     0.9400;
	12	 1	 8.53	 88.0	 0.0	 0.0	 1	     1.0008	    -8.9988	 345.0	 1	     1.0600	     0.9400;
	13	 1	 0.0	 0.0	 0.0	 0.0	 1	     1.0149	    -8.9299	 345.0	 1	     1.0600	     0.9400;
	14	 1	 0.0	 0.0	 0.0	 0.0	 1	     1.0123	   -10.7153	 345.0	 1	     1.0600	     0.9400;
	15	 1	 320.0	 153.0	 0.0	 0.0	 3	     1.0162	   -11.3454	 345.0	 1	     1.0600	     0.9400;
	16	 1	 329.0	 32.3	 0.0	 0.0	 3	     1.0325	   -10.0333	 345.0	 1	     1.0600	     0.9400;
	17	 1	 0.0	 0.0	 0.0	 0.0	 2	     1.0342	   -11.1164	 345.0	 1	     1.0600	     0.9400;
	18	 1	 158.0	 30.0	 0.0	 0.0	 2	     1.0316	   -11.9862	 345.0	 1	     1.0600	     0.9400;
	19	 1	 0.0	 0.0	 0.0	 0.0	 3	     1.0501	    -5.4101	 345.0	 1	     1.0600	     0.9400;
	20	 1	 680.0	 103.0	 0.0	 0.0	 3	     0.9910	    -6.8212	 345.0	 1	     1.0600	     0.9400;
	21	 1	 274.0	 115.0	 0.0	 0.0	 3	     1.0323	    -7.6287	 345.0	 1	     1.0600	     0.9400;
	22	 1	 0.0	 0.0	 0.0	 0.0	 3	     1.0501	    -3.1831	 345.0	 1	     1.0600	     0.9400;
	23	 1	 247.5	 84.6	 0.0	 0.0	 3	     1.0451	    -3.3813	 345.0	 1	     1.0600	     0.9400;
	24	 1	 308.6	 -92.2	 0.0	 0.0	 3	     1.0380	    -9.9138	 345.0	 1	     1.0600	     0.9400;
	25	 1	 224.0	 47.2	 0.0	 0.0	 2	     1.0577	    -8.3692	 345.0	 1	     1.0600	     0.9400;
	26	 1	 139.0	 17.0	 0.0	 0.0	 2	     1.0526	    -9.4388	 345.0	 1	     1.0600	     0.9400;
	27	 1	 281.0	 75.5	 0.0	 0.0	 2	     1.0383	   -11.3622	 345.0	 1	     1.0600	     0.9400;
	28	 1	 206.0	 27.6	 0.0	 0.0	 3	     1.0504	    -5.9284	 345.0	 1	     1.0600	     0.9400;
	29	 1	 283.5	 26.9	 0.0	 0.0	 3	     1.0501	    -3.1699	 345.0	 1	     1.0600	     0.9400;
	30	 2	 0.0	 0.0	 0.0	 0.0	 2	     1.0499	    -7.3705	 345.0	 1	     1.0600	     0.9400;
	31	 3	 9.2	 4.6	 0.0	 0.0	 1	     0.9820	     0.0000	 345.0	 1	     1.0600	     0.9400;
	32	 2	 0.0	 0.0	 0.0	 0.0	 1	     0.9841	    -0.1884	 345.0	 1	     1.0600	     0.9400;
	33	 2	 0.0	 0.0	 0.0	 0.0	 3	     0.9972	    -0.1932	 345.0	 1	     1.0600	     0.9400;
	34	 2	 0.0	 0.0	 0.0	 0.0	 3	     1.0123	    -1.6311	 345.0	 1	     1.0600	     0.9400;
	35	 2	 0.0	 0.0	 0.0	 0.0	 3	     1.0494	     1.7765	 345.0	 1	     1.0600	     0.9400;
	36	 2	 0.0	 0.0	 0.0	 0.0	 3	     1.0636	     4.4684	 345.0	 1	     1.0600	     0.9400;
	37	 2	 0.0	 0.0	 0.0	 0.0	 2	     1.0275	    -1.5829	 345.0	 1	     1.0600	     0.9400;
	38	 2	 0.0	 0.0	 0.0	 0.0	 3	     1.0265	     3.8928	 345.0	 1	     1.0600	     0.9400;
	39	 2	 1104.0	 250.0	 0.0	 0.0	 1	     1.0300	   -14.5353	 345.0	 1	     1.0600	     0.9400;
];

%% generator data
%	bus	Pg	Qg	Qmax	Qmin	Vg	mBase	status	Pmax	Pmin	Pc1	Pc2	Qc1min	Qc1max	Qc2min	Qc2max	ramp_agc	ramp_10	ramp_30	ramp_q	apf
mpc.gen = [
	30	 250.0	 161.762	 400.0	 140.0	 1.0499	 100.0	 1	 1040.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0;
	31	 677.871	 221.574	 300.0	 -100.0	 0.982	 100.0	 1	 646.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0;
	32	 650.0	 206.965	 300.0	 150.0	 0.9841	 100.0	 1	 725.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0;
	33	 632.0	 108.293	 250.0	 0.0	 0.9972	 100.0	 1	 652.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0;
	34	 508.0	 166.688	 167.0	 0.0	 1.0123	 100.0	 1	 508.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0;
	35	 650.0	 210.661	 300.0	 -100.0	 1.0494	 100.0	 1	 687.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0;
	36	 560.0	 100.165	 240.0	 0.0	 1.0636	 100.0	 1	 580.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0;
	37	 540.0	 -1.36945	 250.0	 0.0	 1.0275	 100.0	 1	 564.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0;
	38	 830.0	 21.7327	 300.0	 -150.0	 1.0265	 100.0	 1	 865.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0;
	39	 1000.0	 78.4674	 300.0	 -100.0	 1.03	 100.0	 1	 1100.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0	 0.0;
];

%% generator cost data
%	2	startup	shutdown	n	c(n-1)	...	c0
mpc.gencost = [
	2	 0.0	 0.0	 3	   0.010500	  15.370000	 240.000000;
	2	 0.0	 0.0	 3	   0.009000	  11.290000	 200.000000;
	2	 0.0	 0.0	 3	   0.009000	   8.800000	 220.000000;
	2	 0.0	 0.0	 3	   0.009500	   8.000000	 250.000000;
	2	 0.0	 0.0	 3	   0.008500	  11.400000	 220.000000;
	2	 0.0	 0.0	 3	   0.007500	  10.450000	 190.000000;
	2	 0.0	 0.0	 3	   0.009000	  10.030000	 200.000000;
	2	 0.0	 0.0	 3	   0.009000	  10.150000	 210.000000;
	2	 0.0	 0.0	 3	   0.007000	   7.980000	 230.000000;
	2	 0.0	 0.0	 3	   0.006000	   8.000000	 220.000000;
];

%% branch data
%	fbus	tbus	r	x	b	rateA	rateB	rateC	ratio	angle	status	angmin	angmax
mpc.branch = [
	1	 2	 0.0035	 0.0411	 0.6987	 600.0	 600.0	 600.0	 0.0	 0.0	 1	 -30.0	 30.0;
	1	 39	 0.001	 0.025	 0.75	 1000.0	 1000.0	 1000.0	 0.0	 0.0	 1	 -30.0	 30.0;
	2	 3	 0.0013	 0.0151	 0.2572	 500.0	 500.0	 500.0	 0.0	 0.0	 1	 -30.0	 30.0;
	2	 25	 0.007	 0.0086	 0.146	 500.0	 500.0	 500.0	 0.0	 0.0	 1	 -30.0	 30.0;
	2	 30	 0.0	 0.0181	 0.0	 900.0	 900.0	 2500.0	 1.025	 0.0	 1	 -30.0	 30.0;
	3	 4	 0.0013	 0.0213	 0.2214	 500.0	 500.0	 500.0	 0.0	 0.0	 1	 -30.0	 30.0;
	3	 18	 0.0011	 0.0133	 0.2138	 500.0	 500.0	 500.0	 0.0	 0.0	 1	 -30.0	 30.0;
	4	 5	 0.0008	 0.0128	 0.1342	 600.0	 600.0	 600.0	 0.0	 0.0	 1	 -30.0	 30.0;
	4	 14	 0.0008	 0.0129	 0.1382	 500.0	 500.0	 500.0	 0.0	 0.0	 1	 -30.0	 30.0;
	5	 6	 0.0002	 0.0026	 0.0434	 1200.0	 1200.0	 1200.0	 0.0	 0.0	 1	 -30.0	 30.0;
	5	 8	 0.0008	 0.0112	 0.1476	 900.0	 900.0	 900.0	 0.0	 0.0	 1	 -30.0	 30.0;
	6	 7	 0.0006	 0.0092	 0.113	 900.0	 900.0	 900.0	 0.0	 0.0	 1	 -30.0	 30.0;
	6	 11	 0.0007	 0.0082	 0.1389	 480.0	 480.0	 480.0	 0.0	 0.0	 1	 -30.0	 30.0;
	6	 31	 0.0	 0.025	 0.0	 1800.0	 1800.0	 1800.0	 1.07	 0.0	 1	 -30.0	 30.0;
	7	 8	 0.0004	 0.0046	 0.078	 900.0	 900.0	 900.0	 0.0	 0.0	 1	 -30.0	 30.0;
	8	 9	 0.0023	 0.0363	 0.3804	 900.0	 900.0	 900.0	 0.0	 0.0	 1	 -30.0	 30.0;
	9	 39	 0.001	 0.025	 1.2	 900.0	 900.0	 900.0	 0.0	 0.0	 1	 -30.0	 30.0;
	10	 11	 0.0004	 0.0043	 0.0729	 600.0	 600.0	 600.0	 0.0	 0.0	 1	 -30.0	 30.0;
	10	 13	 0.0004	 0.0043	 0.0729	 600.0	 600.0	 600.0	 0.0	 0.0	 1	 -30.0	 30.0;
	10	 32	 0.0	 0.02	 0.0	 900.0	 900.0	 2500.0	 1.07	 0.0	 1	 -30.0	 30.0;
	12	 11	 0.0016	 0.0435	 0.0	 500.0	 500.0	 500.0	 1.006	 0.0	 1	 -30.0	 30.0;
	12	 13	 0.0016	 0.0435	 0.0	 500.0	 500.0	 500.0	 1.006	 0.0	 1	 -30.0	 30.0;
	13	 14	 0.0009	 0.0101	 0.1723	 600.0	 600.0	 600.0	 0.0	 0.0	 1	 -30.0	 30.0;
	14	 15	 0.0018	 0.0217	 0.366	 600.0	 600.0	 600.0	 0.0	 0.0	 1	 -30.0	 30.0;
	15	 16	 0.0009	 0.0094	 0.171	 600.0	 600.0	 600.0	 0.0	 0.0	 1	 -30.0	 30.0;
	16	 17	 0.0007	 0.0089	 0.1342	 600.0	 600.0	 600.0	 0.0	 0.0	 1	 -30.0	 30.0;
	16	 19	 0.0016	 0.0195	 0.304	 600.0	 600.0	 2500.0	 0.0	 0.0	 1	 -30.0	 30.0;
	16	 21	 0.0008	 0.0135	 0.2548	 600.0	 600.0	 600.0	 0.0	 0.0	 1	 -30.0	 30.0;
	16	 24	 0.0003	 0.0059	 0.068	 600.0	 600.0	 600.0	 0.0	 0.0	 1	 -30.0	 30.0;
	17	 18	 0.0007	 0.0082	 0.1319	 600.0	 600.0	 600.0	 0.0	 0.0	 1	 -30.0	 30.0;
	17	 27	 0.0013	 0.0173	 0.3216	 600.0	 600.0	 600.0	 0.0	 0.0	 1	 -30.0	 30.0;
	19	 20	 0.0007	 0.0138	 0.0	 900.0	 900.0	 2500.0	 1.06	 0.0	 1	 -30.0	 30.0;
	19	 33	 0.0007	 0.0142	 0.0	 900.0	 900.0	 2500.0	 1.07	 0.0	 1	 -30.0	 30.0;
	20	 34	 0.0009	 0.018	 0.0	 900.0	 900.0	 2500.0	 1.009	 0.0	 1	 -30.0	 30.0;
	21	 22	 0.0008	 0.014	 0.2565	 900.0	 900.0	 900.0	 0.0	 0.0	 1	 -30.0	 30.0;
	22	 23	 0.0006	 0.0096	 0.1846	 600.0	 600.0	 600.0	 0.0	 0.0	 1	 -30.0	 30.0;
	22	 35	 0.0	 0.0143	 0.0	 900.0	 900.0	 2500.0	 1.025	 0.0	 1	 -30.0	 30.0;
	23	 24	 0.0022	 0.035	 0.361	 600.0	 600.0	 600.0	 0.0	 0.0	 1	 -30.0	 30.0;
	23	 36	 0.0005	 0.0272	 0.0	 900.0	 900.0	 2500.0	 1.0	 0.0	 1	 -30.0	 30.0;
	25	 26	 0.0032	 0.0323	 0.531	 600.0	 600.0	 600.0	 0.0	 0.0	 1	 -30.0	 30.0;
	25	 37	 0.0006	 0.0232	 0.0	 900.0	 900.0	 2500.0	 1.025	 0.0	 1	 -30.0	 30.0;
	26	 27	 0.0014	 0.0147	 0.2396	 600.0	 600.0	 600.0	 0.0	 0.0	 1	 -30.0	 30.0;
	26	 28	 0.0043	 0.0474	 0.7802	 600.0	 600.0	 600.0	 0.0	 0.0	 1	 -30.0	 30.0;
	26	 29	 0.0057	 0.0625	 1.029	 600.0	 600.0	 600.0	 0.0	 0.0	 1	 -30.0	 30.0;
	28	 29	 0.0014	 0.0151	 0.249	 600.0	 600.0	 600.0	 0.0	 0.0	 1	 -30.0	 30.0;
	29	 38	 0.0008	 0.0156	 0.0	 1200.0	 1200.0	 2500.0	 1.025	 0.0	 1	 -30.0	 30.0;
];

% INFO    : === Translation Options ===
% INFO    : Phase Angle Bound:           30.0 (deg.)
% INFO    : 
% INFO    : === Writing Matpower Case File Notes ===
